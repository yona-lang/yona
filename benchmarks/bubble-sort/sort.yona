module Sort exports main as
    main =
    do
        let
            nums10 = [5, 10, 8, 3, 1, 2, 9, 6, 7, 4]
        in
            (\-> bubble_sort nums10) |> Stopwatch::nanos |> IO::println

        let
#            _ -| args = System::args
#            nums = Seq::reducel args <| Transducers::map int ([], \state val -> state |- val, identity)
            nums100 = [509, 620, 337, 529, 653, 145, 778, 563, 494, 322, 250, 134, 12, 553, 727, 870, 647, 200, 316, 385, 706, 537, 419, 312, 808, 869, 76, 764, 71, 446, 79, 643, 352, 380, 215, 255, 837, 256, 650, 93, 783, 251, 389, 461, 95, 226, 866, 347, 646, 929, 397, 979, 518, 28, 400, 55, 407, 437, 812, 31, 609, 152, 794, 42, 991, 768, 916, 284, 668, 414, 867, 415, 569, 701, 858, 44, 213, 36, 913, 732, 175, 203, 705, 450, 965, 94, 863, 724, 470, 387, 321, 785, 261, 686, 533, 853, 454, 683, 8, 720]
        in
            (\-> bubble_sort nums100) |> Stopwatch::nanos |> IO::println

        let
            nums200 = [197, 153, 180, 13, 131, 188, 133, 39, 94, 142, 128, 23, 69, 159, 126, 158, 70, 146, 67, 101, 165, 182, 100, 25, 124, 24, 141, 115, 104, 56, 113, 48, 129, 82, 77, 10, 2, 17, 125, 88, 46, 156, 91, 169, 64, 103, 179, 121, 50, 196, 38, 57, 176, 33, 47, 85, 127, 107, 134, 52, 81, 109, 178, 199, 76, 42, 192, 106, 187, 44, 1, 22, 185, 3, 54, 5, 195, 184, 9, 45, 135, 60, 173, 123, 36, 6, 53, 30, 157, 144, 111, 55, 27, 155, 92, 137, 75, 79, 95, 7, 40, 190, 119, 194, 200, 168, 61, 98, 34, 12, 102, 26, 160, 170, 11, 172, 19, 163, 49, 112, 65, 4, 28, 78, 29, 162, 183, 152, 105, 41, 32, 164, 43, 84, 140, 148, 99, 86, 108, 120, 117, 130, 198, 21, 68, 66, 171, 83, 139, 118, 116, 62, 132, 51, 174, 97, 145, 20, 177, 96, 58, 191, 59, 18, 80, 93, 35, 143, 166, 189, 15, 114, 122, 186, 175, 87, 72, 161, 151, 37, 193, 136, 16, 8, 74, 167, 110, 149, 63, 147, 138, 90, 89, 154, 150, 71, 14, 181, 31, 73]
        in
            (\-> bubble_sort nums200) |> Stopwatch::nanos |> IO::println

        let
            nums300 = [93, 147, 298, 211, 94, 156, 118, 83, 21, 27, 297, 3, 192, 249, 167, 131, 210, 238, 134, 186, 224, 28, 14, 164, 148, 74, 217, 53, 209, 142, 254, 289, 239, 240, 119, 9, 244, 132, 154, 300, 61, 182, 52, 219, 288, 79, 208, 40, 23, 103, 193, 226, 106, 100, 153, 166, 212, 220, 59, 60, 48, 86, 181, 121, 268, 264, 229, 31, 126, 82, 62, 290, 47, 232, 34, 17, 246, 5, 242, 233, 111, 84, 180, 76, 273, 160, 122, 50, 140, 176, 191, 101, 205, 55, 6, 32, 73, 69, 248, 78, 7, 162, 291, 296, 128, 138, 35, 235, 16, 295, 188, 190, 157, 98, 213, 4, 284, 125, 234, 2, 29, 117, 243, 26, 253, 214, 179, 206, 68, 116, 19, 150, 39, 104, 197, 13, 97, 245, 255, 10, 107, 171, 184, 183, 45, 120, 135, 258, 130, 20, 70, 203, 115, 260, 274, 87, 43, 257, 281, 143, 42, 102, 216, 223, 95, 199, 177, 46, 152, 222, 265, 194, 252, 37, 286, 215, 231, 285, 12, 173, 196, 144, 266, 67, 165, 33, 200, 41, 81, 56, 58, 269, 280, 283, 170, 207, 155, 282, 49, 85, 159, 127, 57, 1, 25, 65, 225, 198, 133, 139, 8, 299, 267, 137, 227, 91, 22, 168, 71, 228, 24, 51, 105, 80, 204, 66, 272, 145, 141, 169, 151, 109, 279, 44, 201, 72, 54, 287, 112, 270, 174, 129, 75, 123, 175, 136, 113, 161, 277, 18, 293, 256, 36, 187, 77, 250, 63, 11, 271, 99, 30, 276, 92, 275, 259, 237, 158, 294, 110, 278, 292, 38, 251, 230, 114, 261, 163, 64, 96, 263, 89, 185, 172, 262, 108, 247, 146, 15, 218, 88, 124, 178, 195, 189, 90, 221, 241, 149, 202, 236]
        in
            (\-> bubble_sort nums300) |> Stopwatch::nanos |> IO::println
    end

    min x y | x < y = x
            | true = y

    max x y | x < y = y
            | true = x

    bubble_up [] = []
    bubble_up [x] = [x]
    bubble_up x -| y -| xs =
        let
            smaller = min x y
            larger = max x y
        in
            smaller -| (bubble_up (larger -| xs))

    bubble_sort l = Seq::foldl (\acc _ -> bubble_up acc) l [0 .. Seq::len l]
end
